FROM python:3.10-slim

WORKDIR /app

# Copy requirements and install dependencies
COPY requirements.txt .
RUN pip install -r requirements.txt

# Copy setup.py and source code
COPY setup.py .
COPY src/anemonefish_acoustics /app/src/anemonefish_acoustics
COPY src/api /app/src/api
COPY src/model/latest /app/src/model/latest

# Install the anemonefish_acoustics package
RUN pip install -e .

EXPOSE 8001

CMD ["uvicorn", "src.api.app:app", "--host", "0.0.0.0", "--port", "8001"]